{
  "version": 3,
  "sources": ["service-discovery.ts"],
  "sourcesContent": ["import * as cloudmap from '../../aws-servicediscovery';\nimport { Construct } from 'constructs';\nimport { CfnVirtualNode } from './appmesh.generated';\n\n                                                       \nexport interface ServiceDiscoveryConfig {\n                                                                                                \n  readonly dns?: CfnVirtualNode.DnsServiceDiscoveryProperty;\n\n                                                                                                            \n  readonly cloudmap?: CfnVirtualNode.AwsCloudMapServiceDiscoveryProperty;\n}\n\n                                                      \nexport enum DnsResponseType {\n                                                                                                                                                                                                                           \n  LOAD_BALANCER = 'LOADBALANCER',\n\n                                                                                                                                                                                  \n  ENDPOINTS = 'ENDPOINTS',\n}\n\n                                                                   \nexport abstract class ServiceDiscovery {\n                                                                                                                                                                                                                   \n  public static dns(hostname: string, responseType?: DnsResponseType): ServiceDiscovery {\n    return new DnsServiceDiscovery(hostname, responseType);\n  }\n\n                                                                                                                                                                                                                                                                                                                                                                                                                                                \n  public static cloudMap(service: cloudmap.IService, instanceAttributes?: {[key: string]: string}): ServiceDiscovery {\n    return new CloudMapServiceDiscovery(service, instanceAttributes);\n  }\n\n                                                                                        \n  public abstract bind(scope: Construct): ServiceDiscoveryConfig;\n}\n\nclass DnsServiceDiscovery extends ServiceDiscovery {\n  private readonly hostname: string;\n  private readonly responseType?: DnsResponseType;\n\n  constructor(hostname: string, responseType?: DnsResponseType) {\n    super();\n    this.hostname = hostname;\n    this.responseType = responseType;\n  }\n\n  public bind(_scope: Construct): ServiceDiscoveryConfig {\n    return {\n      dns: {\n        hostname: this.hostname,\n        responseType: this.responseType,\n      },\n    };\n  }\n}\n\nclass CloudMapServiceDiscovery extends ServiceDiscovery {\n  private readonly service: cloudmap.IService;\n  private readonly instanceAttributes?: {[key: string]: string};\n\n  constructor(service: cloudmap.IService, instanceAttributes?: {[key: string]: string}) {\n    super();\n    this.service = service;\n    this.instanceAttributes = instanceAttributes;\n  }\n\n  public bind(_scope: Construct): ServiceDiscoveryConfig {\n    return {\n      cloudmap: {\n        namespaceName: this.service.namespace.namespaceName,\n        serviceName: this.service.serviceName,\n        attributes: renderAttributes(this.instanceAttributes),\n      },\n    };\n  }\n}\n\nfunction renderAttributes(attrs?: {[key: string]: string}) {\n  if (attrs === undefined) { return undefined; }\n  return Object.entries(attrs).map(([key, value]) => ({ key, value }));\n}\n"],
  "mappings": "+OAcA,GAAY,iBAAZ,AAAA,UAAY,iBAAe,CAEzB,iBAAA,cAAA,eAGA,iBAAA,UAAA,cALU,gBAAA,QAAA,iBAAA,SAAA,gBAAe,KAS3B,sBAAsC,OAEtB,KAAI,SAAkB,aAA8B,sFACzD,GAAI,qBAAoB,SAAU,oBAI7B,UAAS,QAA4B,mBAA4C,mFACtF,GAAI,0BAAyB,QAAS,qBARjD,QAAA,iBAAA,8HAeA,iCAAkC,iBAAgB,CAIhD,YAAY,SAAkB,aAA8B,CAC1D,QACA,KAAK,SAAW,SAChB,KAAK,aAAe,aAGf,KAAK,OAAiB,CAC3B,MAAO,CACL,IAAK,CACH,SAAU,KAAK,SACf,aAAc,KAAK,gBAM3B,sCAAuC,iBAAgB,CAIrD,YAAY,QAA4B,mBAA4C,CAClF,QACA,KAAK,QAAU,QACf,KAAK,mBAAqB,mBAGrB,KAAK,OAAiB,CAC3B,MAAO,CACL,SAAU,CACR,cAAe,KAAK,QAAQ,UAAU,cACtC,YAAa,KAAK,QAAQ,YAC1B,WAAY,iBAAiB,KAAK,uBAM1C,0BAA0B,MAA+B,CACvD,GAAI,QAAU,OACd,MAAO,QAAO,QAAQ,OAAO,IAAI,CAAC,CAAC,IAAK,SAAY,EAAE,IAAK",
  "names": []
}
