{
  "version": 3,
  "sources": ["oidc-provider.ts"],
  "sourcesContent": ["import * as path from 'path';\nimport {\n  Arn,\n  CustomResource,\n  CustomResourceProvider,\n  CustomResourceProviderRuntime,\n  IResource,\n  Resource,\n  Token,\n} from '../../core';\nimport { Construct } from 'constructs';\n\nconst RESOURCE_TYPE = 'Custom::AWSCDKOpenIdConnectProvider';\n\n                                                        \nexport interface IOpenIdConnectProvider extends IResource {\n                                                                                   \n  readonly openIdConnectProviderArn: string;\n\n                                             \n  readonly openIdConnectProviderIssuer: string;\n}\n\n                                                                 \nexport interface OpenIdConnectProviderProps {\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    \n  readonly url: string;\n\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           \n  readonly clientIds?: string[];\n\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      \n  readonly thumbprints?: string[];\n}\n\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          \nexport class OpenIdConnectProvider extends Resource implements IOpenIdConnectProvider {\n                                                                                                                                                                                                  \n  public static fromOpenIdConnectProviderArn(scope: Construct, id: string, openIdConnectProviderArn: string): IOpenIdConnectProvider {\n    const resourceName = Arn.extractResourceName(openIdConnectProviderArn, 'oidc-provider');\n\n    class Import extends Resource implements IOpenIdConnectProvider {\n      public readonly openIdConnectProviderArn = openIdConnectProviderArn;\n      public readonly openIdConnectProviderIssuer = resourceName;\n    }\n\n    return new Import(scope, id);\n  }\n\n                                                                                   \n  public readonly openIdConnectProviderArn: string;\n\n  public readonly openIdConnectProviderIssuer: string;\n\n                                                                                                                                                                   \n  public constructor(scope: Construct, id: string, props: OpenIdConnectProviderProps) {\n    super(scope, id);\n\n    const resource = new CustomResource(this, 'Resource', {\n      resourceType: RESOURCE_TYPE,\n      serviceToken: this.getOrCreateProvider(),\n      properties: {\n        ClientIDList: props.clientIds,\n        ThumbprintList: props.thumbprints,\n        Url: props.url,\n      },\n    });\n\n    this.openIdConnectProviderArn = Token.asString(resource.ref);\n    this.openIdConnectProviderIssuer = Arn.extractResourceName(this.openIdConnectProviderArn, 'oidc-provider');\n  }\n\n  private getOrCreateProvider() {\n    return CustomResourceProvider.getOrCreate(this, RESOURCE_TYPE, {\n      codeDirectory: path.join(__dirname, 'oidc-provider'),\n      runtime: CustomResourceProviderRuntime.NODEJS_12_X,\n      policyStatements: [\n        {\n          Effect: 'Allow',\n          Resource: '*',\n          Action: [\n            'iam:CreateOpenIDConnectProvider',\n            'iam:DeleteOpenIDConnectProvider',\n            'iam:UpdateOpenIDConnectProviderThumbprint',\n            'iam:AddClientIDToOpenIDConnectProvider',\n            'iam:RemoveClientIDFromOpenIDConnectProvider',\n          ],\n        },\n      ],\n    });\n  }\n}\n"],
  "mappings": "4NAAA,KAAA,QAAA,QACA,OAAA,QAAA,cAWM,cAAgB,sCAwBtB,mCAA2C,QAAA,QAAQ,CAmBjD,YAAmB,MAAkB,GAAY,MAAiC,CAChF,MAAM,MAAO,kFAEb,KAAM,UAAW,GAAI,QAAA,eAAe,KAAM,WAAY,CACpD,aAAc,cACd,aAAc,KAAK,sBACnB,WAAY,CACV,aAAc,MAAM,UACpB,eAAgB,MAAM,YACtB,IAAK,MAAM,OAIf,KAAK,yBAA2B,OAAA,MAAM,SAAS,SAAS,KACxD,KAAK,4BAA8B,OAAA,IAAI,oBAAoB,KAAK,yBAA0B,uBA/B9E,8BAA6B,MAAkB,GAAY,yBAAgC,CACvG,KAAM,cAAe,OAAA,IAAI,oBAAoB,yBAA0B,iBAEvE,oBAAqB,QAAA,QAAQ,CAA7B,aAAA,qBACkB,KAAA,yBAA2B,yBAC3B,KAAA,4BAA8B,cAGhD,MAAO,IAAI,QAAO,MAAO,IA0BnB,qBAAmB,CACzB,MAAO,QAAA,uBAAuB,YAAY,KAAM,cAAe,CAC7D,cAAe,KAAK,KAAK,UAAW,iBACpC,QAAS,OAAA,8BAA8B,YACvC,iBAAkB,CAChB,CACE,OAAQ,QACR,SAAU,IACV,OAAQ,CACN,kCACA,kCACA,4CACA,yCACA,oDAjDZ,QAAA,sBAAA",
  "names": []
}
